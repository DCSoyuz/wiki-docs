---
id: mk-structure
title: Состав, карта памяти
sidebar_label: Состав, карта памяти
sidebar_position: 3
---

## Блок схема

<div className="doc-image-container">
<figure>
  <img src="/img/5400TP105-003/structure/блок_схема_105-003.svg" alt="Блок схема 5400ТР105-003" />
  <figcaption  className="doc-image-container__image-title">Блок схема 5400ТР105-003</figcaption>
</figure>
</div>

## Состав микроконтроллера

### Системные устройства

- <a href="/docs/5400TP105-003/mk-core8051">CPU_8051</a> – процессорное ядро;
- TAP (Test Access Port) – автомат JTAG;
- TDR (Test Data Register) – регистры данных JTAG;
- MUX – мультиплексор;
- <a href="/docs/5400TP105-003/mk-analog-cfg">ANALOG_CFG_MEM</a> – конфигурационная память;
- ROM_OTP_4KB (One-Time Programmable) – однократно программируемое постоянное запоминающее устройство емкостью 4 КБ, память программ устройства;
- RAM_ROM_4KB – оперативное запоминающее устройство емкостью 4 КБ, микроконтроллер работает с данным модулем, как с памятью программ или памятью данных в зависимости   
  от значения вывода DBG;
- RAM_256B – оперативное запоминающее устройство емкостью 256B, для хранения промежуточных данных, память данных устройства;
- SWITCH – модуль, разграничивающий доступ к RAM_OTP_4KB, RAM_ROM_4KB, RAM_256B;
- SWITCH JTAG/CPU – модуль, разграничивающий доступ к шине для JTAG и CPU;
- POR (Power-On Reset) – модуль сброса при включении;
- BOR (Brown-Out Reset) – модуль сброса при снижении напряжения питания;
- PMM (Power Management Module) – модуль системы управления сбросом и питанием;
- GEN_PLL – модуль ввода-вывода и фазовой автоподстройки частоты (ФАПЧ) тактирования;
- RC – RC-генератор;
- CMM (Clock Management Module) – модуль управления источниками тактовых сигналов системы;
- DEBUGGER – отладчик;
- OA_TUNE – масштабирующий операционный усилитель (МОУ);
- V_REF – источник опорного напряжения (ИОН);
- LDO_15V->5V, LDO_5V->3V7, LDO_5V->1V8 – линейные регуляторы напряжения.

### Периферийные устройства

- INT_CTRL – контроллер прерываний;
- SPI0, SPI1 – модули SPI;
- UART0, UART1 – модули UART;
- I2C – модуль I2C;
- GPIOA, GPIOB, GPIOC – контроллеры портов ввода-вывода;
- TIMER0, TIMER1, TIMER2 – универсальные таймеры;
- WDT – сторожевой таймер;
- WORK_FSM – рабочий автомат для режима «SLEEP»;
- OWI – модуль 1-Wire;
- DAC – цифро-аналоговый преобразователь.
- ADC – аналого-цифрой преобразователь;

## Карта памяти

Адресное пространство памяти программ и данных разделено. В данное адресное пространство отображаются различные модули памяти и периферии.

<table className="table">
<tbody>

<tr>
    <th>№</th>
    <th>Выделенное пространство</th>
    <th>Зона</th>
    <th >Аббревиатура</th>
    <th >Описание</th>
  </tr>

  <tr>
    <td >0000h</td>
    <td >4 КБ</td>
    <td >ПЗУ</td>
    <td >ROM</td>
    <td >ПЗУ</td>
  </tr>
  <tr>
    <td >0000h</td>
    <td >4352 Б</td>
    <td rowSpan={22}>ОЗУ</td>
    <td >RAM</td>
    <td >ОЗУ</td>
  </tr>
  <tr>
    <td >2000h</td>
    <td >256 Б</td>
    <td >PMM</td>
    <td >Подсистема управления электропитанием</td>
  </tr>
    <tr>
    <td >2100h</td>
    <td >256 Б</td>
    <td >CMM</td>
    <td >Подсистема управления тактированием </td>
  </tr>
      <tr>
    <td >2200h</td>
    <td >256 Б</td>
    <td >WDT</td>
    <td >Сторожевой таймер </td>
  </tr>
      <tr>
    <td >2300h</td>
    <td >256 Б</td>
    <td >GPIOA </td>
    <td rowSpan={3}>Универсальные порты ввода-вывода</td>
  </tr>
      <tr>
    <td >2400h</td>
    <td >256 Б</td>
    <td >GPIOB </td>
    
  </tr>
      <tr>
    <td >2500h</td>
    <td >256 Б</td>
    <td >GPIOC </td>
    
  </tr>
      <tr>
    <td >2600h</td>
    <td >256 Б</td>
    <td >SPI0</td>
    <td rowSpan={2}>Интерфейсы SPI </td>
  </tr>
      <tr>
    <td >2700h</td>
    <td >256 Б</td>
    <td >SPI1</td>
    
  </tr>
      <tr>
    <td >2800h</td>
    <td >256 Б</td>
    <td >UART0</td>
    <td rowSpan={2}>Интерфейсы UART</td>
  </tr>
      <tr>
    <td >2900h</td>
    <td >256 Б</td>
    <td >UART1</td>
  </tr>
      <tr>
    <td >2A00h</td>
    <td >256 Б</td>
    <td >I2C</td>
    <td >Интерфейс I2C</td>
  </tr>
    <tr>
    <td >2B00h</td>
    <td >256 Б</td>
    <td >OWI</td>
    <td >Интерфейс 1-WIRE</td>
  </tr>
      <tr>
    <td >2C00h</td>
    <td >256 Б</td>
    <td >WORK_FSM</td>
    <td >Рабочий автомат</td>
  </tr>
    <tr>
    <td >2D00h</td>
    <td >32 Б</td>
    <td >TIMER0</td>
    <td rowSpan={3}>Таймеры </td>
  </tr>
      <tr>
    <td >2D20h</td>
    <td >32 Б</td>
    <td >TIMER1</td>
  </tr>
      <tr>
    <td >2D40h</td>
    <td >32 Б</td>
    <td >TIMER2</td>
  </tr>
        <tr>
    <td >2F00h</td>
    <td >256 Б</td>
    <td >ADC</td>
    <td >Аналого-цифровой преобразователь</td>
  </tr>
      <tr>
    <td >3000h</td>
    <td >256 Б</td>
    <td >DAC</td>
    <td >Цифро-аналоговый преобразователь</td>
  </tr>
        <tr>
    <td >3100h</td>
    <td >256 Б</td>
    <td >INT_CTRL</td>
    <td >Контроллер прерываний </td>
  </tr>
        <tr>
    <td >3200h</td>
    <td >64 Б</td>
    <td >DEBUGGER</td>
    <td >Отладчик </td>
  </tr>
        <tr>
    <td >3300h</td>
    <td >8 Б</td>
    <td >ANALOG_CFG</td>
    <td >Конфигурационная память аналоговых блоков</td>
  </tr>
  </tbody>
</table>

Если CPU обратится по адресу вне выделенного пространства, то при чтении будут приняты нулевые данные, запись не будет иметь никакого эффекта.

## Распределение адресного пространства

Микроконтроллеры 8051 оперируют двумя типами памяти: памятью программ и памятью данных. Память программ и память данных физически и логически разделены, имеют различные механизмы адресации, работают под управлением различных сигналов и выполняют разные функции.

<table className="table">
<tbody>

  <tr>
    <th >Структура памяти в режиме «HARD»</th>
    <th >Структура памяти в режиме «SOFT»</th>
  </tr>
  <tr>
    <td>
    <img src="/img/5400TP105-003/structure/память_ОЗУ.svg" alt="" />
    </td>
    <td>
    <img src="/img/5400TP105-003/structure/память_ПЗУ.svg" alt="" />
    </td>
  </tr>
</tbody>
</table>

Обращение к внешней памяти данных осуществляется по команде «movx», а обращение к памяти программ по команде «movc».

Структура резидентной памяти данных представлена на рисунке. Первые 32 байта сгруппированы в 4 банка по 8 регистров R0 - R7.
Команды микроконтроллера могут обращаться к ним как к регистрам общего назначения R0 - R7 и как к ячейкам ОЗУ с прямой адресацией от 00h до 1Fh. Ячейки резидентного ОЗУ с адреса 20h до адреса 2Fh обеспечивают кроме прямой адресации, адресацию 128 битов (0-127).

<div className="doc-image-container">
<figure>
  <img src="/img/5400TP105-003/structure/структура_внутреннего_ОЗУ.svg" alt="" />
  <figcaption  className="doc-image-container__image-title">Структура резидентной памяти данных</figcaption>
</figure>
</div>

Резидентная память данных имеет 8-битную шину адреса, через которую обеспечивается доступ к памяти из регистра адреса – RAR или из регистра-указателя стека – SP. Регистр-указатель стека используется микроконтроллером при работе со стеком. Через регистр адреса осуществляется прямая и косвенная адресация памяти данных.
