---
id: plis-dcsprog
title: DCSProg
sidebar_label: DCSProg
sidebar_position: 3
---

import DocumentFigure from '@site/src/components/ui/DocumentFigure';
import DocumentLink from '@site/src/components/ui/DocumentLink';

## Описание DCSProg

Программное обеспечение DCSProg предназначено для программирования микросхемы.

:::tip
Загрузить архив DCSProg можно с сайта компании https://dcsoyuz.ru (раздел «Программное
обеспечение»). Доступ к разделу «Программное обеспечение» предоставляется по запросу
на электронную почту support@dcsoyuz.ru.
:::

При распаковке архива используйте пути, содержащие только латинские буквы, цифры и символы,
безопасные для файловых систем (например, `C:\path\to\directory`).

### Основные разделы DCSProg

#### Помощь

- `«Информация о отладочном комплекте»` – позволяет узнать версию ПО DCSProg,
  отладочной платы, программатора, программы программатора и серийный номер
  программатора.
- `«Обновить ПО»` – обновление программного обеспечения программатора.

#### Микросхема

- `«Загрузить файл несжатого образа ПЛИС»` – выбор несжатого образа для последующей
  загрузки в энергозависимую память (далее SOFT режим).
- `«Загрузить файл сжатого образа ПЛИС»` – выбор сжатого образа для последующей загрузки
  в энергонезависимую память (далее HARD режим).
- `«Записать ОЗУ в ПЛИС несжатый образ»` – запись образа в энергозависимую память.
- `«Записать в ПЗУ ПЛИС сжатый образ»` – запись образа в энергонезависимую память.
- `«Настройка цифровой конфигурационной памяти»` – позволяет производить настройку
  системы тактирования (D[7:0]) и статически конфигурируемых выводов DIO1, DIO5, DIO9,
  DIO13, DIO17, DIO21, DIO25, DIO29, DIO33 (D[16:8]).

#### VDD

- `«VDDA»` – изменение напряжения питания ПЛИС. По умолчанию 5,0 В.
- `«VDDR»` – изменение напряжения питания цифровой части ПЛИС. По умолчанию 3,3 В.
  Допускается подавать VDDDR=2,5 В…5,0 B при любом напряжении питания VDDA.

#### Режим

- `«HARD режим»` – переключение режима работы микросхемы в «HARD».
- `«SOFT режим»` – переключение режима работы микросхемы в «SOFT». Данный режим
  установлен по умолчанию.
- `«SPI режим»` – режим для совместной работы микросхемы ПЛИС с микросхемой ПЗУ
  5400РТ015.

Подробнее см. раздел [«Переключение режимов работы»](/docs/5400TC015/programming/plis-dcsprog#переключение-режимов-работы).

#### GCLK

- `«Частота»` – выбор значения частоты 2, 4, 8, 16 МГц. По умолчанию 16 МГц.
- `«Направление»` – выбор вывода GCLK1-GCLK4 на который подается частота. По умолчанию
  GCLK1.
- `«Выкл. внешнюю частоту»` – выключение генератора.

Подробнее см. раздел [«Тактирование»](/docs/5400TC015/programming/plis-dev-kit#тактирование)

#### 5400РТ015

- `«Сформировать прошивку из сжатого образа»` – создание прошивки для микросхемы памяти
  5400РТ015 из сжатого образа ПЛИС.
- `«Сформировать прошивку из несжатого образа»` – создание прошивки для микросхемы
  памяти 5400РТ015 из несжатого образа ПЛИС.

Подробнее см. раздел [«Создание конфигурации для микросхемы памяти 5400РТ015»](/docs/5400TC015/programming/#создание-конфигурации-для-микросхемы-памяти-5400рт015).

#### Конфигурационная память

В данном меню можно записать в ПЗУ конфигурационной памяти биты настройки, отвечающие
за формат образа, загружаемого по интерфейсу SPI в режиме Self-Programmer и настроить режим
скрабирования памяти.

| Регистр   | Описание                                                                                                                                                            |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **RAW**   | Формат прошивки, используемый при загрузке в режиме Self-Programmer по SPI:<br/>0 – сжатый образ (по умолчанию).<br/>1 – несжатый образ.                            |
| **SCRUB** | Настройка скрабирования памяти:<br/>[2]: 1 – разрешено / 0 – запрещено.<br/>[1]: 1 – несжатый / 0 – сжатый.<br/>[0]: источник данных: 1 – SPI / 0 – встроенное ПЗУ. |

- `«Прожечь бит TECH_ROM.RAW»` – Изменение формата прошивки, используемого
  при загрузке в режиме Self-Programmer по интерфейсу SPI на несжатый образ.
- `«Режимы скрабирования памяти»`
- `«Прожечь бит SCRUB.ENABLE»` – включение режима скрабирования памяти.
- `«Прожечь бит SCRUB.RAW»` – установка работы с несжатым образом.
- `«Прожечь бит SCRUB.SPI»` – установка SPI режима.

:::danger Важно!
Нельзя использовать конфигурации, в которых тип образа ПЛИС в регистрах RAW и
SCRUB различаются.

Запрещенные конфигурации

<table className="table">
  <thead>
    <tr>
      <th>RAW</th>
      <th>SCRUB [2]</th>
      <th>SCRUB [1]</th>
      <th>SCRUB [0]</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>Сжатый образ, скрабирование разрешено, несжатый формат, источник SPI</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>X</td>
      <td>Несжатый образ, скрабирование разрешено, сжатый формат, источник SPI/ПЗУ</td>
    </tr>
    <tr>
      <td>X</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>Скрабирование разрешено, несжатый формат, источник – встроенное ПЗУ</td>
    </tr>
  </tbody>
</table>

:::

## Структура образа программы

Образ программы, загружаемый в ПЛИС, может быть представлен в двух форматах: сжатом
и несжатом.

Несжатый формат включает 676 x 678 + 8 + 9 бит данных, которые передаются в ПЛИС
непрерывным потоком напрямую в ОЗУ и используется только в режиме «SOFT». Однако
из-за большого размера несжатого образа его невозможно записать во внутреннее ПЗУ микросхемы.

Сжатый формат создается на основе несжатого и позволяет настроить внутреннее ПЗУ для работы
в режиме «HARD». Прошивка ПЗУ возможна только с использованием сжатого образа.

8 дополнительных бит отвечают за настройку системы тактирования ПЛИС, а 9 бит — за конфигурацию
статических выводов ПЛИС.

<table className="table ">
  <thead>
    <tr>
      <th>Биты</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>676 * 678</td>
      <td>Образ ПЛИС</td>
    </tr>
    <tr>
      <td>1:0</td>
      <td>
        Настройка FROM_PAD_CLK1:

        [0] драйвер КП: «0» – RC генератор, «1» – ПЛИС

        [1] драйвер ПЛИС: «0» – внешний, «1» – RC генератор
      </td>
    </tr>
    <tr>
      <td>3:2</td>
      <td>Настройка FROM_PAD_CLK2</td>
    </tr>
    <tr>
      <td>5:4</td>
      <td>Настройка FROM_PAD_CLK3</td>
    </tr>
    <tr>
      <td>7:6</td>
      <td>Настройка FROM_PAD_CLK4</td>
    </tr>
    <tr>
      <td>16:8</td>
      <td>
        Настройка направления ввода/вывода (IO):
        
        «0» – вход, «1» – выход
        
        [8] – DIO1
        
        [9] – DIO5
        
        [10] – DIO9
        
        [11] – DIO13
        
        [12] – DIO17
        
        [13] – DIO21
        
        [14] – DIO25
        
        [15] – DIO29
        
        [16] – DIO33
      </td>
    </tr>
  </tbody>
</table>

## Настройка конфигурационной памяти

Конфигурационная память может работать в одном из двух режимов:

- Режим считывания конфигурационной памяти из ОЗУ (далее **режим «SOFT»** - PR = 1,5 B)
- Режим считывания конфигурационной памяти из ПЗУ (далее **режим «HARD»** - PR = 0 B)

Настройку тактирования системы и статически конфигурируемых выводов можно выполнить
в DCSProg.

Для этого выберите `«Микросхема» – «Настройка цифровой конфигурационной памяти»`.
Откроется диалоговое окно, где можно установить необходимые биты.

<DocumentFigure src="/img/5400ТС015/dcsprog/dcsprog-conf-memory.png" alt="Меню настройки цифровой конфигурационной памяти" caption="Меню настройки цифровой конфигурационной памяти" />

По умолчанию цифровая конфигурационная память работает в режиме «HARD».

Для новой конфигурации:

1. Установите требуемые биты настройки D[7:0] > и D[16:8].
2. Нажмите `«PR = 1,5 В»` для принудительного перевода цифровой конфигурационной памяти
   в режим «SOFT».
3. Нажмите кнопку `«Прошить»`.

После этого конфигурационная память будет работать в режиме «SOFT» c установленными
настройками. Данный режим предназначен для отладки.

Для записи в ПЗУ нажмите `«Прожечь» – режим «HARD»`.
:::info Примечание
Конфигурационная цифровая память является однократно программируемой. После нажатия
кнопки «Прожиг» изменение конфигурации невозможно.
:::

:::warning Важно
При работе конфигурационной памяти в режиме «SOFT» (PR = 1,5 B) микросхема
потребляет около 200 мА, а также происходит разогрев микросхемы регулятора напряжения
на отладочной плате. Продолжительная работа в этом режиме не рекомендуется. Режим предназначен
только для отладки памяти.

После отладки необходимо перевести конфигурационную память в режим
«HARD». Для этого в DCSProg нажмите `«Микросхема» – «Настройка цифровой конфигурационной
памяти»` и в открывшемся окне нажмите `«PR = 0 В»`.

:::

## Переключение режимов работы

При включении отладочного комплекта микросхема по умолчанию работает в режиме «SOFT».

Для смены режима в DCSProg необходимо нажать «Режим» и выбрать нужный режим работы.

Доступны следующие режимы:

- «SOFT»
- «HARD»
- «SPI»

**Режим «SOFT»**: чтение несжатого образа из ОЗУ. При отключении питания все данные в ОЗУ будут
стерты. Этот режим предназначен для отладки программ и работает по умолчанию при включении
отладочного комплекта.

**Режим «HARD»**: чтение сжатого образа из ПЗУ.

**Режим «SPI»**: микросхема работает как «ведущее устройство», передавая код инструкции и
адресные биты по линии MOSI «ведомому». Этот режим используется для загрузки конфигурации
из микросхемы памяти 5400РТ015, которая должна быть подключена к выводам EXT_MEM ([отладочная плата, позиция 7](/docs/5400TC015/programming/plis-dev-kit#отладочная-плата)).

## Обновление программного обеспечения

Текущую версию программного обеспечения можно узнать через меню `«Помощь» – «Информация
об отладочном комплекте»`, пункт `«Версия программы»`.

<DocumentFigure src="/img/5400ТС015/dcsprog/dcsprog-po-version.png" alt="Отображение информации о отладочном комплекте" caption="Отображение информации о отладочном комплекте" />

Для обновления необходимо воспользоваться опцией `«Помощь» – «Обновить ПО»`. 

Процесс обновления выполняется с использованием файла **prog_firmware.hex**, который должен находиться
в корневой директории программы DCSProg. 

Если файл отсутствует или имеет некорректное имя,
в диалоговом окне будет отображено сообщение об ошибке обновления.

<DocumentFigure src="/img/5400ТС015/dcsprog/dcsprog-po-update.png" alt="Сообщение о неудачном обновлении" caption="Сообщение о неудачном обновлении" />

Как правило, установленная версия программы актуальна и обновление требуется лишь в случае
критических сбоев. 

Файлы для обновления предоставляются технической поддержкой по запросу
на электронную почту support@dcsoyuz.ru.


:::warning Важно!

Во время обновления прошивки запрещено закрывать приложение DCSProg, отключать
питание отладочного комплекта или отключать отладочный комплект от ПК. Это приведет
к некорректной загрузке ПО. При этом после некорректного обновления повторно загрузить файл
обновления будет невозможно. В случае ошибки обновления в DCSProg будет отображена ошибка.
Свяжитесь с нами по почте support@dcsoyuz.ru если вы столкнулись с ошибкой обновления.

:::
