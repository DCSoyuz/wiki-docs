---
id: mk025-pmm
title: Система управления сбросом и питанием
sidebar_label: Система управления сбросом и питанием
sidebar_position: 7
---

<div className="doc-image-container">
<figure>
  <img src="/img/5400ВК025/pmm/Управление_сбросом_и_питанием.svg" alt="" />
  <figcaption  className="doc-image-container__image-title">Структурная схема системы управления сбросом и питанием</figcaption>
</figure>
</div>

Система управления сбросом и питанием состоит из следующих блоков:

- REGISTERS – блок для хранения управляющих данных и статусов;
- RST/CPU_SLEEP_CONTROL – блок управления сбросом и сном процессора, формирует системный сброс и разрешение на переход в режим «Сон процессора».

## Формирование сброса

Выводы POR и PGM имеют активный уровень «0». Вывод PGM работает, только когда вывод TM находится в «0». RST/CPU_SLEEP_CONTROL формирует синхронный сигнал сброса системы RST_N из внешнего асинхронного сигнала POR_RST. Микроконтроллер может быть сброшен программными методами от сторожевого таймера (сигнал WDT_RST) или через JTAG (сигнал JTAG_RST). Следует иметь введу, что JTAG и DEBUGGER сбрасывается только по сигналу POR_RST. В модуле CMM регистры, связанные с выбором и настройкой текущей частоты сбрасываются только по POR_RST, однако регистры CMM_ST, CMM_MSK и регистры, связанные с переходами в какой-либо режим «SLEEP», сбрасываются еще и по WDT_RST и JTAG_RST. Таким образом, после сброса от сторожевого таймера или JTAG система продолжит работу на прежней частоте или продолжит переход на другую частоту, а если находится в режиме «SLEEP», то выйдет из него.

Также блок RST/CPU_SLEEP_CONTROL на основании данных блока REGISTERS формирует сигнал разрешения перехода в режим «Сон процессора» для модуля CMM (сигнал CPU_SLEEP_EN).

## Регистры модуля системы управления сбросом и питанием

| №     | Аббревиатура | Доступ | Описание           |
| ----- | ------------ | ------ | ------------------ |
| 2000h | PMM_CTRL     | W      | Регистр управления |
| 2001h | PMM_ST       | R      | Регистр статусов   |

### PMM_CTRL

<table className="table">
<tbody>
 
  <tr>
    <th >Бит</th>
    <th >7</th>
    <th >6</th>
    <th >5</th>
    <th >4</th>
    <th >3</th>
    <th >2</th>
    <th >1</th>
    <th >0</th>
  </tr>

  <tr>
    <th >Назначение</th>
    <td colSpan={6} >Резерв</td>
    <td >COLD_SLEEP</td>
    <td >CPU_SLEEP_EN</td>
  </tr>

  <tr>
    <th >Начальное значение</th>
    <th colSpan={8} >0</th>
  </tr>
</tbody>
</table>

**CPU_SLEEP_EN** – переход в режим «Сон процессора»;

- 1 – перейти в режим «Сон процессора»;
- 0 – режим «Сон процессора» выключен.

**COLD_SLEEP** – переход в режим «Холодный сон»

- 1 – перейти в режим «Холодный сон»;
- 0 – режим «Холодный сон» выключен.

### PMM_ST

<table className="table">
<tbody>
 
  <tr>
    <th >Бит</th>
    <th >7</th>
    <th >6</th>
    <th >5</th>
    <th >4</th>
    <th >3</th>
    <th >2</th>
    <th >1</th>
    <th >0</th>
  </tr>

  <tr>
    <th >Назначение</th>
    <td rowSpan={2} colSpan={6} >Резерв</td>
    <td >JTAG_RST</td>
    <td >WDT_RST</td>
  </tr>
    <tr>
    <th >Тип статуса</th>
    <td colSpan={2} >EVENT</td>
  </tr>

  <tr>
    <th >Начальное значение</th>
    <td colSpan={8} >0</td>
  </tr>
</tbody>
</table>

**JTAG_RST** – зафиксирован сброс по JTAG.

**WDT_RST** – зафиксирован сброс по сторожевому таймеру.
