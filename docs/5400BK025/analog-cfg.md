---
id: mk025-analog-cfg
title: Кофигурационная память
sidebar_label: Конфигурационная память
sidebar_position: 3
---

В микросхеме реализована конфигурационная память (ANALOG_CFG), которая может работать как в «SOFT», так и в «HARD» режиме. Регистры модуля ANALOG_CFG подключены к конфигурационному однократно программируемому ПЗУ. В зависимости от состояния вывода TM (вывод №7) выводы №2, 3, 4, 5, 24, 25, 26 имеют разное назначение.

| № вывода | При TM = 0 | При TM = 1 |
| -------- | ---------- | ---------- |
| 2        | GPIO3      | TDO        |
| 3        | GPIO2      | TDI        |
| 4        | GPIO1      | TMC        |
| 5        | GPIO0      | TCK        |
| 6        | GPIO7      | RC_F       |
| 7        | GPIO6      | RC_S       |
| 8        | GPIO5      | H_S        |

В зависимости от вывода H_S (вывод №26 при TM = «1») источником данных конфигурационной памяти могут быть либо регистры (H_S = «1», SOFT-режим), либо ПЗУ (H_S = «0», HARD-режим).

Для прожига конфигурационной памяти необходимо в «SOFT» режиме подать 9,0 В на вывод VPP.

| №     | Аббревиатура  | Доступ | Описание                                                                                           |
| ----- | ------------- | ------ | -------------------------------------------------------------------------------------------------- |
| 2А00h | ANALOG_O_RCF  | W      | Регистр настройки емкости конденсатора высокочастотного RC-генератора                              |
| 2А01h | ANALOG_O_RCS  | W      | Регистр настройки емкости конденсатора низкочастотного RC-генератора                               |
| 2А02h | ANALOG_O_RC_R | W      | Регистр настройки сопротивления резистора низкочастотного RC-генератора                            |
| 2А04h | ANALOG_O_GEN  | W      | Регистр выбора высокочастотного RC-генератора, внешнего генератора, источника для прожига ПЗУ 64 Б |

### ANALOG_O_RCF

<table className="table">
<tbody>
  <tr>
    <th >Бит</th>
    <th >7</th>
    <th >6</th>
    <th >5</th>
    <th >4</th>
    <th >3</th>
    <th >2</th>
    <th >1</th>
    <th >0</th>
  </tr>

   <tr>
    <th >Назначение</th>
    <td  colSpan={2} >Резерв</td>
    <td  colSpan={6} >RCF_C</td>
  </tr>

   <tr>
    <th >Начальное значение</th>
    <td  colSpan={8} >0</td>
  </tr>
  
</tbody>
</table>

**RCF_C** – настройка емкости конденсатора высокочастотного RC-генератора.

### ANALOG_O_RCS

<table className="table">
<tbody>
  <tr>
    <th >Бит</th>
    <th >7</th>
    <th >6</th>
    <th >5</th>
    <th >4</th>
    <th >3</th>
    <th >2</th>
    <th >1</th>
    <th >0</th>
  </tr>

   <tr>
    <th >Назначение</th>
    <td  colSpan={2} >Резерв</td>
    <td  colSpan={6} >RCS_C</td>
  </tr>

   <tr>
    <th >Начальное значение</th>
    <td  colSpan={8} >0</td>
  </tr>
  
</tbody>
</table>

**RCS_C** – настройка емкости конденсатора низкочастотного RC-генератора.

### ANALOG_O_RC_R

<table className="table">
<tbody>
  <tr>
    <th >Бит</th>
    <th >7</th>
    <th >6</th>
    <th >5</th>
    <th >4</th>
    <th >3</th>
    <th >2</th>
    <th >1</th>
    <th >0</th>
  </tr>

   <tr>
    <th >Назначение</th>
    <td  colSpan={2} >Резерв*</td>
    <td  colSpan={3} >RC2_R</td>
    <td  colSpan={3} >Резерв</td>
  </tr>

   <tr>
    <th >Начальное значение</th>
    <td  colSpan={8} >0</td>
  </tr>
  
</tbody>
</table>

_Резерв_ \* – Не изменять начальное значение.

**RC2_R** – настройка сопротивления резистора низкочастотного RC-генератора.

Встроенный низкочастотный RC-генератор настраивается с помощью переменного конденсатора (биты RCS_C регистра ANALOG_O_RCS) и переменного резистора (биты RC2_R регистра ANALOG_O_RC_R).

Таблица с типовыми значениями частоты низкочастотного генератора представлена ниже.

<table className="table">
<tbody>
  <tr>
    <th rowSpan={2}>Биты RC2_R*</th>
    <th colSpan={3}>Биты RCS_C**</th>
  </tr>
  <tr>
    <th >111111</th>
    <th >•••</th>
    <th >000000</th>
  </tr>
  <tr>
    <td >000</td>
    <td >~90 кГц</td>
    <td >•••</td>
    <td >~420 кГц</td>
  </tr>
  <tr>
    <td >001</td>
    <td >~80 кГц</td>
    <td >•••</td>
    <td >~380 кГц</td>
  </tr>
   <tr>
    <td >010</td>
    <td >~70 кГц</td>
    <td >•••</td>
    <td >~330 кГц</td>
  </tr>
    <tr>
    <td >011</td>
    <td >~60 кГц</td>
    <td >•••</td>
    <td >~280 кГц</td>
  </tr>
    <tr>
    <td >100</td>
    <td >~45 кГц</td>
    <td >•••</td>
    <td >~225 кГц</td>
  </tr>
    <tr>
    <td >101</td>
    <td >~35 кГц</td>
    <td >•••</td>
    <td >~170 кГц</td>
  </tr>
   <tr>
    <td >110</td>
    <td >~25 кГц</td>
    <td >•••</td>
    <td >~115 кГц</td>
  </tr>
   <tr>
    <td >111</td>
    <td >~12 кГц</td>
    <td >•••</td>
    <td >~60 кГц</td>
  </tr>
  
</tbody>
</table>

RC2_R\* – Биты RC2_R регистра ANALOG_O_RC_R.

RCS_C\*\* – Биты RCS_C регистра ANALOG_O_RCS.

Частота встроенного генератора может иметь первоначальный разброс от типового значения вследствие технологического разброса (от образца к образцу), напряжения питания и температуры. Гарантируемым диапазоном настройки низкочастотного генератора является частота от 20 кГц до 200 кГц. Точное требуемое значение выбирается подстройкой указанных выше бит.

Встроенный высокочастотный генератор настраивается только с помощью переменного конденсатора (биты RCF_C регистра ANALOG_O_RCF). Однако, стоит учитывать, что частота тактирования микроконтроллера не более 8 МГц.

Таблица с типовыми значениями частоты высокочастотного генератора представлена ниже.

<table className="table">
<tbody>
  <tr>
    <th colSpan={3}>Биты RCS_C*</th>
  </tr>
  <tr>
    <th >111111</th>
    <th >•••</th>
    <th >000000</th>
  </tr>
  <tr>
    <td >≤ 5,0 МГц</td>
    <td >•••</td>
    <td >≥ 10 МГц</td>
  </tr>
  
</tbody>
</table>

Биты RCS_C\* – Биты RCF_C регистра ANALOG_O_RCF.

### ANALOG_O_GEN

<table className="table">
<tbody>
  <tr>
    <th >Бит</th>
    <th >7</th>
    <th >6</th>
    <th >5</th>
    <th >4</th>
    <th >3</th>
    <th >2</th>
    <th >1</th>
    <th >0</th>
  </tr>

   <tr>
    <th >Назначение</th>
    <td  colSpan={5} >Резерв*</td>
    <td  >LDO</td>
    <td  >A_RCX</td>
    <td  >A_RC</td>
  </tr>

   <tr>
    <th >Начальное значение</th>
    <td  colSpan={8} >0</td>
  </tr>
  
</tbody>
</table>

Резерв\* – Не изменять начальное значение.

**LDO** – выбор источника для прожига ПЗУ 64Б:

- 1 – внешнее напряжение для прожига;
- 0 – встроенный линейный регулятор.

**A_RCX** – выбор внешнего генератора:

- 1 – внешний генератор;
- 0 – кварцевый генератор с внешним резонатором.

**A_RC** – выбор высокочастотного генератора:

- 1 – внешний генератор;
- 0 – встроенный генератор.
